<!DOCTYPE html>
<html>
<head>
    <title>YouTube Downloader</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        input, button { padding: 10px; margin: 5px; }
        input[type="url"] { width: 400px; }
        .formats { margin-top: 20px; }
        .format { margin: 10px 0; padding: 10px; border: 1px solid #ddd; }
    </style>
</head>
<body>
    <h1>YouTube Downloader</h1>
    <input type="url" id="urlInput" placeholder="Enter YouTube URL">
    <button onclick="getFormats()">Get Download Links</button>
    
    <div id="result"></div>

    <script>
        async function getFormats() {
            const url = document.getElementById('urlInput').value;
            const result = document.getElementById('result');
            
            if (!url) {
                result.innerHTML = '<p style="color: red;">Please enter a URL</p>';
                return;
            }

            result.innerHTML = '<p>Loading...</p>';

            try {
                const response = await fetch('/.netlify/functions/download', {
                    method: 'POST',
                    body: JSON.stringify({ url })
                });

                const data = await response.json();

                if (response.ok) {
                    result.innerHTML = `
                        <h3>${data.title}</h3>
                        <div class="formats">
                            ${data.formats.map(f => `
                                <div class="format">
                                    <strong>${f.quality}</strong> (${f.container})
                                    <br><a href="${f.url}" download>Download</a>
                                </div>
                            `).join('')}
                        </div>
                    `;
                } else {
                    result.innerHTML = `<p style="color: red;">Error: ${data.error}</p>`;
                }
            } catch (error) {
                result.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html>